-provide(:page, 'category')
.row
  -# Category column
  .col-md-4
    =link_to "+ Add category", new_account_admin_category_path, {:remote => true,"data-target" => "#myModal", "data-toggle" => "modal", "class" => "btn btn-light w-100 text-secondary border-secondary p-4", :style => "border: dashed;"}
    #myModal.modal.hide.fade{"aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog"}
      .modal-dialog{:role => "document"}
        .modal-content
    #v-pills-tab-category.nav.flex-column.nav-pills.w-100.mt-5{"aria-orientation" => "vertical", :role => "tablist"}
      - @categories.each_with_index do |category, index|
        .nav-link.w-100.my-2.btn.btn-light.text-secondary.category-button{:id => "v-pills-category-#{category.id}-tab", "aria-controls" => "v-pills-category-#{category.id}", "aria-selected" => "true", "data-toggle" => "pill", :href => "#v-pills-subcategory#{category.id}", :role => "tab"}
          .w-100.text-right
            %div(class="dropdown" )
              %a{:class => "text-danger btn p-0",
                    :type => "button btn-sm",
                    :id => "dropdownMenuButton",
                    "data-toggle" => "dropdown",
                    :style => "wight: bolder; border: none;",
                    :aria-expanded => "false"} ...
              %div(class="dropdown-menu p-2 m-0" aria-labelledby="dropdownMenuButton" style="border: none" )
                = link_to "delete", account_admin_category_path(id: category.id), method: :delete, :class => "dropdown-item"
                = link_to "edit", edit_account_admin_category_path(id: category.id), method: :get, :remote => true, :class => "dropdown-item", "data-target" => "#myModal", "data-toggle" => "modal"
          = category.name
  .col-md-4
    =render "account/admin/sub_category/_part/index", categories: @categories
  .col-md-4
    =render "account/admin/team/_part/index", categories: @categories

:css
  #v-pills-tab-category .nav-link,
  #v-pills-tab-subcategory .nav-link {
    border: dashed #6c757d;
  }

  #v-pills-tab-category .nav-link.active,
  #v-pills-tab-subcategory .nav-link.active {
    border: none;
    color: red !important;
  }

:javascript
    var load = true;

    function getCookie(name) {
    let matches = document.cookie.match(new RegExp(
      "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
    ));
    return matches ? decodeURIComponent(matches[1]) : undefined;
  }

  function setCookie(name, value, options = {}) {
    options = {
      path: '/',
    };
    if (options.expires instanceof Date) {
      options.expires = options.expires.toUTCString();
    }
    let updatedCookie = encodeURIComponent(name) + "=" + encodeURIComponent(value);
    for (let optionKey in options) {
      updatedCookie += "; " + optionKey;
      let optionValue = options[optionKey];
      if (optionValue !== true) {
        updatedCookie += "=" + optionValue;
      }
    }
    document.cookie = updatedCookie;
  }

  $(function (){
    if (getCookie('category-button') == undefined) {
      $('.category-button:first').click();
    } else {
      $('#'+getCookie('category-button')).click()
    }
  })

  $('.category-button').click(function(){
    var sub_category = $(this).attr('href');
    $('.tab-team.active').removeClass('active');
    setCookie('category-button', $(this).attr('id'));
    if (load == true && getCookie('sub-category-button') != undefined) {
      $('#'+getCookie('sub-category-button')).click();
      load = false;
    } else {
      $(sub_category + ' .sub-category-button:first').click();
      setCookie('sub-category-button', $(sub_category + ' .sub-category-button:first').attr('id'));
    }
  })

  $('.sub-category-button').click(function (){
    setCookie('sub-category-button', $(this).attr('id'));
  })
